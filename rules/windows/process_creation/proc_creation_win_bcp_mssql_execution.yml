title: MSSQL BCP Utility Execution
id: 3f4b3b7d-4b7e-4b3b-8b7d-4b7e4b3b8b7d
status: stable
description: Detects the abuse of the BCP utility to export data which might indicate malware deployment on MS-SQL servers.
references:
  - https://docs.microsoft.com/en-us/sql/tools/bcp-utility
  - https://asec.ahnlab.com/en/61000/
  - https://www.huntress.com/blog/attacking-mssql-servers
author: Omar Khaled (@beacon_exe)
date: 2024/03/11
tags:
  - attack.execution
  - attack.t1048
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|endswith: '\bcp.exe'
    CommandLine|contains: 'queryout'
  condition: selection
falsepositives:
  - Legitimate data export operations
level: medium
